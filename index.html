<!doctype html>
<head>
    <meta charset="utf-8">
    <title>abcdefg</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="/layui/css/layui.css" rel="stylesheet"/>
    <link href="/css/base.css" rel="stylesheet"/>
</head>
<body>
<div class="a1">
	<div class="b1">
		<ul class="d1">
			<li>
				<span>-></span>
				<a href="category">博客分类</a>
			</li>
			<li>
				<span>-></span>
				<a href="times">时间轴</a>
			</li>
			<li>
				<span>-></span>
				<a href="tags">标签列表</a>
			</li>
			<li>
				<span>-></span>
				<a href="/login">管理员登陆</a>
			</li>
			<li>
				<span>-></span>
				<a href="console">控制台 : #(session.user.name)</a>
			</li>
			<li>
				<span>-></span>
				<a href="/temp/logout">登出</a>
			</li>
		</ul>
	</div>
</div>

<script src="/layui/layui.js"></script>
<script>
    layui.use(['axios', 'jsencrypt'], function(){
		axios = layui.axios;
		encrypt = layui.jsencrypt;

        login("ggboy","123");

		async function login(loginNumber, pwd) {
            try {
            	var result = await axios.get("/api/rsa/publicKey");
            	if (result.data.code != 'OK') {
            	    console.log(result.data.message)
					return false;
				}
            	encrypt.setPublicKey(result.data.data);
            	pwd = encrypt.encrypt(pwd);

                result = await axios.post("/api/login", {loginNumber:loginNumber,password:pwd});
                if (result.data.code != 'OK') {
                    console.log(result.data.message)
                    return false;
                }
                return true;
			} catch (e) {
			    if (e.response.status == 404)
			        window.location = "/404.html";
            }
			console.log(result.data);
			return result;
		}
    });

</script>
</body>
</html>